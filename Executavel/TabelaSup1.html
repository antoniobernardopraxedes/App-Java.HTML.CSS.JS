<!DOCTYPE html>
<head>
  <title>Supervisao e Controle</title> 
  <style>
    table, th, td {border: 1px solid black; padding: 3px; border-collapse: collapse; background-color: #f1f1c1;}
  </style>
  <meta charset="UTF-8">
  <meta name="description" content="Programa de Apresentação para Supervisão e Controle">
  <meta name="keywords" content="HTML,CSS,XML,JavaScript">
  <meta name="author" content="Antonio Bernardo Praxedes">
</head> 

<body>
		             
  <table>
	
	<tr><!-- Linha 00 --> 
      <td colspan="10" align="center">Supervisao e Controle Agua, Energia e Usina Solar</td>
    </tr>
    
    <tr><!-- Linha 01 --> 
      <td colspan="2">Conexão Servidor</td>
      <td align="center" id="comsrv">-----</td>
      <td colspan="2">Conexão Concentrador</td>
      <td align="center" id="comcnc">-----</td>
      <td colspan="2">Conexão UTR</td>
      <td align="center" id="comutr">-----</td>
      <td> <button type="button" onclick="loadXMLDoc('cmd=0004')">Normal</button></td>
    </tr>
    
    <tr><!-- Linha 02 --> 
      <td colspan="2">Conexão C. Carga 1</td>
      <td align="center" id="comcc1"></td>
      <td colspan="2">Conexão C. Carga 2</td>
	  <td align="center" id="comcc2">-----</td>
      <td>Hora UTR:</td>
	  <td align="center" id="data">-----</td>
	  <td align="center" id="clk">-----</td>
      <td> <button type="button" onclick="loadXMLDoc('cmd=0003')">Economia</button></td>
    </tr>
    
    <tr><!-- Linha 03 -->
	  <td colspan="3" id="cmdex">-----</td>
	  <td colspan="2">Temperatura Baterias</td>
	  <td align="center" id="tbat" >-----</td>
	  <td colspan="2">Estado do Inversor 2</td>
	  <td align="center" id="estiv2">-----</td>
	  <td> <button type="button" onclick="loadXMLDoc('cmd=0016')">Manual 1</button></td>
	</tr>
		        	        
	<tr><!-- Linha 04 -->
	  <td colspan="2">Tensão Barramento</td>
      <td align="center" id="vbat">-----</td>
	  <td colspan="2">Saúde Baterias</td>
	  <td align="center" id="sdbat">-----</td>
	  <td colspan="2">Corrente Entrada Inv2</td>
	  <td align="center" id="ieiv2">-----</td>
	  <td> <button type="button" onclick="loadXMLDoc('cmd=0017')">Auto 1</button></td>
    </tr>
        
	<tr><!-- Linha 05 -->
	  <td>Tensão Rede</td>
      <td align="center" id="estvrd">-----</td>
      <td align="center" id="vrede">-----</td>
	  <td colspan="2">Tensão Paineis 1 e 2</td>
	  <td align="center" id="vp12">-----</td>
	  <td colspan="2">Potência Entrada Inv2</td>
	  <td align="center" id="weiv2">-----</td>
	  <td> <button type="button" onclick="loadXMLDoc('cmd=0005')">Manual 234</button></td>
    </tr>
    
	<tr><!-- Linha 06 -->
	  <td colspan="2">Modo de Operação</td>
	  <td align="center" id="mdop">-----</td>
	  <td colspan="2">Corrente Painéis 1 e 2</td>
	  <td align="center" id="is12">-----</td>
	  <td colspan="2">Tensão Saida Inv2</td>
	  <td align="center" id="vsiv2">-----</td>
	  <td> <button type="button" onclick="loadXMLDoc('cmd=0006')">Auto 234</button></td>
	</tr>
		        
	<tr><!-- Linha 07 -->
	  <td colspan="2">Modo de Comando</td>
	  <td align="center" id="mdcom">-----</td>
	  <td colspan="2">Corrente Saida CC1</td>
	  <td align="center" id="iscc1">-----</td>
	  <td colspan="2">Corrente Saida Inv2</td>
	  <td align="center" id="isiv2">-----</td>
	  <td> <button type="button" onclick="loadXMLDoc('cmd=0002')">Acerta</button></td>
	</tr>
	
	<tr><!-- Linha 08 -->
	  <td colspan="2">Modo Controle 1</td>
	  <td align="center" id="mdct1">-----</td>
	  <td colspan="2">Potência Saida CC1</td>
	  <td align="center" id="wscc1">-----</td>
	  <td colspan="2">Potência Saida Inv2</td>
	  <td align="center" id="wsiv2">-----</td>
	  <td> <button type="button" onclick="loadXMLDoc('cmd=0015')">Apaga</button></td>
	</tr>
	
	<tr><!-- Linha 09 -->
	  <td colspan="2">Modo Controle 234</td>
	  <td align="center" id="mdct234">-----</td>
	  <td colspan="2">Saúde CC1</td>
	  <td align="center" id="sdcc1">-----</td>
	  <td colspan="2">Temperatura Driver Inv2</td>
	  <td align="center" id="tdiv2">-----</td>
	  <td> <button type="button" onclick="loadXMLDoc('cmd=0007')">Habilita 1</button></td>
	</tr>
	
	<tr><!-- Linha 10 -->
	  <td colspan="2">Energia Carga 1</td>
	  <td align="center" id="encg1">-----</td>
	  <td colspan="2">Tensão Painéis 3 e 4</td>
	  <td align="center" id="vp34">-----</td>
	  <td colspan="2">Temperatura Trafo Inv2</td>
	  <td align="center" id="ttiv2">-----</td>
	  <td> <button type="button" onclick="loadXMLDoc('cmd=0008')">Desabilita 1</button></td>
	</tr>
	
	<tr><!-- Linha 11 -->
	  <td colspan="2">Energia Carga 2</td>
	 <td align="center" id="encg2">-----</td>
	  <td colspan="2">Corrente Painéis 3 e 4</td>
	  <td align="center" id="is34">-----</td>
	  <td colspan="2">Eficiencia Inversor 2</td>
	  <td align="center" id="efiv2">-----</td>
	  <td> <button type="button" onclick="loadXMLDoc('cmd=0009')">Habilita 2</button></td>
    </tr>

	<tr><!-- Linha 12 -->
	  <td colspan="2">Energia Carga 3</td>
	  <td align="center" id="encg3">-----</td>
	  <td colspan="2">Corrente Saida CC2</td>
	  <td align="center" id="iscc2">-----</td>
	  <td colspan="2">Saúde Inversor 2</td>
	  <td align="center" id="sdiv2">-----</td>
	  <td> <button type="button" onclick="loadXMLDoc('cmd=0010')">Desabilita 2</button></td>
    </tr>
    
	<tr><!-- Linha 13 -->
	 <td colspan="2">Corrente Carga 3</td>
	  <td align="center" id="icg3">-----</td>
	 <td colspan="2">Potência Saida CC2</td>
	 <td align="center" id="wscc2">-----</td>
	 <td colspan="2">Estado do Inversor 1</td>
	 <td align="center" id="estiv1">-----</td>
	 <td> <button type="button" onclick="loadXMLDoc('cmd=0011')">Habilita 3</button></td>
    </tr>
    
	<tr><!-- Linha 14 -->
	  <td colspan="2">Estado da Caixa Azul</td>
	  <td align="center" id="estcxaz">-----</td>
	  <td colspan="2">Saúde CC2</td>
	  <td align="center" id="sdcc2">-----</td>
	  <td colspan="2">Corrente Entrada Inv1</td>
	  <td align="center" id="ieiv1">-----</td>
	  <td> <button type="button" onclick="loadXMLDoc('cmd=0012')">Desabilita 3</button></td>
    </tr>
		        	        
	<tr><!-- Linha 15 -->
	  <td colspan="2">Nível da Caixa Azul</td>
	  <td align="center" id="nivcxaz">-----</td>
	  <td colspan="2">Corrente Total Gerada</td>
	  <td align="center" id="itotger">-----</td>
	  <td colspan="2">Potência Entrada Inv1</td>
	  <td align="center" id="weiv1">-----</td>
	  <td> <button type="button" onclick="loadXMLDoc('cmd=0013')">Habilita 4</button></td>
	</tr>
		        
	<tr><!-- Linha 16 -->
	  <td colspan="2">Estado da Bomba</td>
	  <td align="center" id="estbmb">-----</td>
	  <td colspan="2">Potência Total Gerada</td>
	  <td align="center" id="wtotger">-----</td>
	  <td colspan="2">Tensão Saida Inv1</td>
	  <td align="center" id="vsiv1">-----</td>
	  <td> <button type="button" onclick="loadXMLDoc('cmd=0014')">Desabilita 4</button></td>
	</tr>
		        
	<tr><!-- Linha 17 -->
	  <td colspan="2">Disjuntor da Bóia</td>
	  <td align="center" id="estdjb">-----</td>
	  <td colspan="2">Corrente Total Cargas</td>
	  <td align="center" id="itotcg">-----</td>
	  <td colspan="2">Corrente Saida Inv1</td>
	  <td align="center" id="isiv1">-----</td>
	  <td> <button type="button" onclick="Atualiza()">Atualiza</button></td>
    </tr>
         	        
	<tr><!-- Linha 18 -->
	  <td colspan="2">Disjuntor Rede Bomba</td>
	  <td align="center" id="estdjrb">-----</td>
	  <td colspan="2">Potência Total Cargas</td>
	  <td align="center" id="wtotcg">-----</td>
	  <td colspan="2">Potência Saida Inv1</td>
	  <td align="center" id="wsiv1">-----</td>
	  <td> <button type="button" onclick="AutoRefresh()">AutoRefresh</button></td>
 	</tr>
 		        	        
	<tr><!-- Linha 19 -->
	  <td colspan="2">Energia Bomba</td>
	<td align="center" id="enbmb">-----</td>
	  <td colspan="2">Estado Fonte CC1</td>
	  <td align="center" id="estft1">-----</td>
	  <td colspan="2">Temperatura Driver Inv1</td>
	  <td align="center" id="tdiv1" >-----</td>
	  <td></td>
	</tr>
		        	        
	<tr><!-- Linha 20 -->
 	  <td colspan="2">Tempo Bomba Ligada</td>
	  <td align="center" id="tmpbl">-----</td>
	  <td colspan="2">Estado Fonte CC2</td>
	  <td align="center" id="estft2">-----</td>
	  <td colspan="2">Temperatura Trafo Inv1</td>
	  <td align="center" id="ttiv1" >-----</td>
	  <td></td>
	</tr>
		        	        
	<tr><!-- Linha 21 -->
	<td colspan="2">Hora Bomba Ligou</td>
	<td align="center">-----</td>
	<td colspan="2">Corrente Cargas 24Vcc</td>
	<td align="center" id="icircc">-----</td>
	<td colspan="2">Eficiência Inversor 1</td>
	<td align="center" id="efiv1">-----</td>
	<td></td>
	</tr>
		                
	<tr><!-- Linha 22 -->
	  <td colspan="2">Hora Bomba Desligou</td>
	  <td align="center">-----</td>
	  <td colspan="2">Potência Cargas 24Vcc</td>
	  <td align="center" id="wcircc">-----</td>
	  <td colspan="2">Saúde Inversor 1</td>
	  <td align="center" id="sdiv1">-----</td>
	  <td></td>
	</tr>
	
	<tr><!-- Linha 22 -->
	<td colspan="10" id="erro">
	</tr>
	
  </table> 
		
  
  <script type="text/javascript">
    //***********************************************************************************************************************
    //                                                                                                                      *
    //                                            Programa Principal Javascript                                             *
    //                                                                                                                      *
    //***********************************************************************************************************************
    //	  
    var toggle = 0;                   // Inicia a variavel de mudanca entre os modos de autorefresh ligado e desligado
    var ModoComando = "";
    loadXMLDoc("local001.xml");       // Solicita os valores de todas as variaveis de supervisao do local: local001
    document.body.style.zoom="100%";
    AutoRefresh();
  
  
    //  Fim da Area de Programa Principal Javascript e Inicio da Area de Funcoes Javascript
    
    
    //***********************************************************************************************************************
    //                                                                                                                      *
    // Nome da Funcao Javascript: Atualiza                                                                                  *
    //                                                                                                                      *
    // Função: faz a atualizacao de todas as variaveis de supervisao                                                        *
    //                                                                                                                      *
    // Entrada: nao tem                                                                                                     *
    //                                                                                                                      *
    //***********************************************************************************************************************
    //	   
    function Atualiza() {
    
      loadXMLDoc();
      if (toggle == 0) {
        document.getElementById("cmdex").innerHTML = "Atualiza";
      }
      
    } // Fim da Rotina AutoRefresh
    
 
    //***********************************************************************************************************************
    //                                                                                                                      *
    // Nome da Funcao Javascript: AutoRefresh                                                                               *
    //                                                                                                                      *
    // Função: faz a atualizacao automatica de todas as variaveis de supervisao                                             *
    //                                                                                                                      *
    // Entrada: variavel global toggle que sinaliza os estados da atualizacao automatica                                    *
    //                                                                                                                      *
    //***********************************************************************************************************************
    //	   
    function AutoRefresh() {
    
      if (toggle == 0) {
        t = setInterval(loadXMLDoc, 3000);
        toggle = 1;
        document.getElementById("cmdex").innerHTML = "Comando Auto Refresh Ligado";
      } else {
	    clearInterval(t);
	    toggle = 0;
	    document.getElementById("cmdex").innerHTML = "Comando Auto Refresh Desligado";
	  }
    } // Fim da Rotina AutoRefresh
	
	
    //***********************************************************************************************************************
    //                                                                                                                      *
    // Nome da Funcao Javascript: loadXMLDoc()                                                                              *
    //                                                                                                                      *
    // Função: solicita ao Servidor um Recurso pelo Metodo GET. A resposta do servidor eh sempre o arquivo XML com o valor  *
    //         atualizado de todas as variaveis de supervisao                                                               *
    //                                                                                                                      *
    // Entrada: String com o nome do Recurso. Se nao for inserida a string com o nome do recurso (valor = undefined),       *
    //          solicita apenas a atualizacao dos valores das variaveis.                                                    *
    //                                                                                                                      *
    //***********************************************************************************************************************
    //	   
    function loadXMLDoc(recurso) { 
  	  
  	  var Metodo = 0;
  	  if (recurso == undefined) {
  	    recurso = "local001.xml";
  	  }
  	    	  
  	  if (recurso == "local001.xml") {
  	    Metodo = 0;
  	  }
  	  else {
  	    Metodo = 1;
  	  }
  	  
  	  if (Metodo == 1) {
  	    if (ModoComando == "Remoto") {
  	      if (recurso == "cmd=0004") { document.getElementById("cmdex").innerHTML = "Comando Modo Normal"; }
  	      if (recurso == "cmd=0016") { document.getElementById("cmdex").innerHTML = "Comando Modo Manual Carga 1"; }
  	      if (recurso == "cmd=0005") { document.getElementById("cmdex").innerHTML = "Comando Modo Manual Cargas 234"; }
  	      if (recurso == "cmd=0002") { document.getElementById("cmdex").innerHTML = "Comando de Acerto de Relogio"; }
  	      if (recurso == "cmd=0007") { document.getElementById("cmdex").innerHTML = "Comando Habilita Carga 1"; }
  	      if (recurso == "cmd=0009") { document.getElementById("cmdex").innerHTML = "Comando Habilita Carga 2"; }
  	      if (recurso == "cmd=0011") { document.getElementById("cmdex").innerHTML = "Comando Habilita Carga 3"; }
  	      if (recurso == "cmd=0013") { document.getElementById("cmdex").innerHTML = "Comando Habilita Carga 4"; }
  	  
  	      if (recurso == "cmd=0003") { document.getElementById("cmdex").innerHTML = "Comando Modo Economia"; }
  	      if (recurso == "cmd=0017") { document.getElementById("cmdex").innerHTML = "Comando Modo Auto Carga 1"; }
  	      if (recurso == "cmd=0006") { document.getElementById("cmdex").innerHTML = "Comando Modo Auto Cargas 234"; }
  	      if (recurso == "cmd=0015") { document.getElementById("cmdex").innerHTML = "Comando Apaga Indicadores de Falha"; }
  	      if (recurso == "cmd=0008") { document.getElementById("cmdex").innerHTML = "Comando Desabilita Carga 1"; }
  	      if (recurso == "cmd=0010") { document.getElementById("cmdex").innerHTML = "Comando Desabilita Carga 2"; }
  	      if (recurso == "cmd=0012") { document.getElementById("cmdex").innerHTML = "Comando Desabilita Carga 3"; }
  	      if (recurso == "cmd=0014") { document.getElementById("cmdex").innerHTML = "Comando Desabilita Carga 4"; }
  	    }
  	    else {
  	      recurso = "local001.xml";
  	      document.getElementById("cmdex").innerHTML = "Comando Não Autorizado (Local)";
  	    }
  	  }
  	  
  	  var xhttp = new XMLHttpRequest();
  	  
  	  if (Metodo == 0) {
        xhttp.open("GET", recurso, false);
      }
      if (Metodo == 1) {
        xhttp.open("POST", recurso, false);
      }
    
      try {
        xhttp.send(); 
		if (xhttp.status != 200) { 
          //alert(`Error ${xhttp.status}: ${xhttp.statusText}`);
          document.getElementById("comsrv").innerHTML = "Falha Arq.";
          document.getElementById("comsrv").style.color = "red";
        } 
        else {                               // Se foi lido corretamente um arquivo HTTP formato XML,
          
          document.getElementById("comsrv").innerHTML = "Normal";
          document.getElementById("comsrv").style.color = "blue";
          
          var xmlRec = xhttp.responseXML;
		  CarregaVariaveis_GERAL(xmlRec);
		  CarregaVariaveis_AGUA(xmlRec);
		  CarregaVariaveis_GERCONS(xmlRec);
		  CarregaVariaveis_INV(xmlRec);
		  document.getElementById("erro").innerHTML = " ";
		  
        } // else if (xhttp.status != 200) {
      } catch(err) {
        document.getElementById("comsrv").innerHTML = "Falha";
        document.getElementById("comsrv").style.color = "red";
        document.getElementById("erro").innerHTML = err;
      }
    } // Fim da Funcao loadXMLDoc
    
    
    //***********************************************************************************************************************
    //                                                                                                                      *
    // Nome da Funcao Javascript: CarregaVariaveis_GERAL                                                                    *
    //                                                                                                                      *
    // Função: carrega na tabela HTML as variaveis de supervisao da seção GERAL lidas do arquivo XML                        *
    //                                                                                                                      *
    // Entrada: variavel com o arquivo XML recebido do Servidor                                                             *
    //                                                                                                                      *
    //***********************************************************************************************************************
    //	   
    function CarregaVariaveis_GERAL(ArqVarXML) { 
      var i = 0;
      var geral = ArqVarXML.getElementsByTagName("GERAL");
      
      valor = geral[i].getElementsByTagName("COMCNV")[0].childNodes[0].nodeValue;
      
      valor = geral[i].getElementsByTagName("COMCNC")[0].childNodes[0].nodeValue;
      document.getElementById("comcnc").innerHTML = valor;
      document.getElementById("comcnc").style.color = CorFonte1(valor);
      
      valor = geral[i].getElementsByTagName("COMUTR")[0].childNodes[0].nodeValue;
      document.getElementById("comutr").innerHTML = valor;
      document.getElementById("comutr").style.color = CorFonte1(valor);
      
      valor = geral[i].getElementsByTagName("COMCC1")[0].childNodes[0].nodeValue;
      document.getElementById("comcc1").innerHTML = valor;
      document.getElementById("comcc1").style.color = CorFonte1(valor);
      
      valor = geral[i].getElementsByTagName("COMCC2")[0].childNodes[0].nodeValue;
      document.getElementById("comcc2").innerHTML = valor;
      document.getElementById("comcc2").style.color = CorFonte1(valor);
      
      valor = geral[i].getElementsByTagName("CLK")[0].childNodes[0].nodeValue;
      document.getElementById("clk").innerHTML = valor;
      valor = geral[i].getElementsByTagName("DATA")[0].childNodes[0].nodeValue;
      document.getElementById("data").innerHTML = valor;
      valor = geral[i].getElementsByTagName("MDOP")[0].childNodes[0].nodeValue;
      document.getElementById("mdop").innerHTML = valor;
      ModoComando = geral[i].getElementsByTagName("MDCOM")[0].childNodes[0].nodeValue;
      document.getElementById("mdcom").innerHTML = ModoComando;
      valor = geral[i].getElementsByTagName("MDCT1")[0].childNodes[0].nodeValue;
      document.getElementById("mdct1").innerHTML = valor;
      valor = geral[i].getElementsByTagName("MDCT234")[0].childNodes[0].nodeValue;
      document.getElementById("mdct234").innerHTML = valor;
      valor = geral[i].getElementsByTagName("ENCG1")[0].childNodes[0].nodeValue;
      document.getElementById("encg1").innerHTML = valor;
      valor = geral[i].getElementsByTagName("ENCG2")[0].childNodes[0].nodeValue;
      document.getElementById("encg2").innerHTML = valor;
      valor = geral[i].getElementsByTagName("ENCG3")[0].childNodes[0].nodeValue;
      document.getElementById("encg3").innerHTML = valor;
      valor = geral[i].getElementsByTagName("ICG3")[0].childNodes[0].nodeValue;
      document.getElementById("icg3").innerHTML = valor;
      valor = geral[i].getElementsByTagName("VBAT")[0].childNodes[0].nodeValue;
      document.getElementById("vbat").innerHTML = valor;
      valor = geral[i].getElementsByTagName("VREDE")[0].childNodes[0].nodeValue;
      document.getElementById("vrede").innerHTML = valor;
      valor = geral[i].getElementsByTagName("ESTVRD")[0].childNodes[0].nodeValue;
      document.getElementById("estvrd").innerHTML = valor;
      valor = geral[i].getElementsByTagName("TBAT")[0].childNodes[0].nodeValue;
      document.getElementById("tbat").innerHTML = valor;
      valor = geral[i].getElementsByTagName("SDBAT")[0].childNodes[0].nodeValue;
      document.getElementById("sdbat").innerHTML = valor;
    
    } // Fim da Rotina CarregaVariaveis_GERAL
    
    
    function CorFonte1(val) {
    
      if (val == "Normal") {
        return("blue");
      }
      else {
        return("red");
      }
    }
    
    
    //***********************************************************************************************************************
    //                                                                                                                      *
    // Nome da Funcao Javascript: CarregaVariaveis_AGUA                                                                     *
    //                                                                                                                      *
    // Função: carrega na tabela HTML as variaveis de supervisao da seção AGUA lidas do arquivo XML                         *
    //                                                                                                                      *
    // Entrada: variavel com o arquivo XML recebido do Servidor                                                             *
    //                                                                                                                      *
    //***********************************************************************************************************************
    //	   
    function CarregaVariaveis_AGUA(ArqVarXML) { 
      var i = 0;
      var agua = ArqVarXML.getElementsByTagName("AGUA");
      valor = agua[i].getElementsByTagName("ESTCXAZ")[0].childNodes[0].nodeValue;
      document.getElementById("estcxaz").innerHTML = valor;
      valor = agua[i].getElementsByTagName("NIVCXAZ")[0].childNodes[0].nodeValue;
      document.getElementById("nivcxaz").innerHTML = valor;
      valor = agua[i].getElementsByTagName("ESTBMB")[0].childNodes[0].nodeValue;
      document.getElementById("estbmb").innerHTML = valor;
      valor = agua[i].getElementsByTagName("ESTDJB")[0].childNodes[0].nodeValue;
      document.getElementById("estdjb").innerHTML = valor;
      valor = agua[i].getElementsByTagName("ESTDJRB")[0].childNodes[0].nodeValue;
      document.getElementById("estdjrb").innerHTML = valor;
      valor = agua[i].getElementsByTagName("ENBMB")[0].childNodes[0].nodeValue;
      document.getElementById("enbmb").innerHTML = valor;
      valor = agua[i].getElementsByTagName("TMPBL")[0].childNodes[0].nodeValue;
      document.getElementById("tmpbl").innerHTML = valor;
      
    } // Fim da Rotina CarregaVariaveis_AGUA


    //***********************************************************************************************************************
    //                                                                                                                      *
    // Nome da Funcao Javascript: CarregaVariaveis_GERCONS                                                                  *
    //                                                                                                                      *
    // Função: carrega na tabela HTML as variaveis de supervisao da seção GERCONS lidas do arquivo XML                      *
    //                                                                                                                      *
    // Entrada: variavel com o arquivo XML recebido do Servidor                                                             *
    //                                                                                                                      *
    //***********************************************************************************************************************
    //	   
    function CarregaVariaveis_GERCONS(ArqVarXML) { 
      var i = 0;
      var gercons = ArqVarXML.getElementsByTagName("GERCONS");
		
      // Controlador de Carga 1 (CC1)
      valor = gercons[i].getElementsByTagName("VP12")[0].childNodes[0].nodeValue;
      document.getElementById("vp12").innerHTML = valor;
      valor = gercons[i].getElementsByTagName("IS12")[0].childNodes[0].nodeValue;
      document.getElementById("is12").innerHTML = valor;
      valor = gercons[i].getElementsByTagName("ISCC1")[0].childNodes[0].nodeValue;
      document.getElementById("iscc1").innerHTML = valor;
      valor = gercons[i].getElementsByTagName("WSCC1")[0].childNodes[0].nodeValue;
      document.getElementById("wscc1").innerHTML = valor;
      valor = gercons[i].getElementsByTagName("SDCC1")[0].childNodes[0].nodeValue;
      document.getElementById("sdcc1").innerHTML = valor;
		        
      // Controlador de Carga 2 (CC2)
      valor = gercons[i].getElementsByTagName("VP34")[0].childNodes[0].nodeValue;
      document.getElementById("vp34").innerHTML = valor;
      valor = gercons[i].getElementsByTagName("IS34")[0].childNodes[0].nodeValue;
      document.getElementById("is34").innerHTML = valor;
      valor = gercons[i].getElementsByTagName("ISCC2")[0].childNodes[0].nodeValue;
      document.getElementById("iscc2").innerHTML = valor;
      valor = gercons[i].getElementsByTagName("WSCC2")[0].childNodes[0].nodeValue;
      document.getElementById("wscc2").innerHTML = valor;
      valor = gercons[i].getElementsByTagName("SDCC2")[0].childNodes[0].nodeValue;
      document.getElementById("sdcc2").innerHTML = valor;
		        
      // Geração e Consumo Totais e Cargas CC
      valor = gercons[i].getElementsByTagName("ITOTGER")[0].childNodes[0].nodeValue;
      document.getElementById("itotger").innerHTML = valor;
      valor = gercons[i].getElementsByTagName("WTOTGER")[0].childNodes[0].nodeValue;
      document.getElementById("wtotger").innerHTML = valor;
      valor = gercons[i].getElementsByTagName("ITOTCG")[0].childNodes[0].nodeValue;
      document.getElementById("itotcg").innerHTML = valor;
      valor = gercons[i].getElementsByTagName("WTOTCG")[0].childNodes[0].nodeValue;
      document.getElementById("wtotcg").innerHTML = valor;
      valor = gercons[i].getElementsByTagName("ESTFT1")[0].childNodes[0].nodeValue;
      document.getElementById("estft1").innerHTML = valor;
      valor = gercons[i].getElementsByTagName("ESTFT2")[0].childNodes[0].nodeValue;
      document.getElementById("estft2").innerHTML = valor;
      valor = gercons[i].getElementsByTagName("ICIRCC")[0].childNodes[0].nodeValue;
      document.getElementById("icircc").innerHTML = valor;
      valor = gercons[i].getElementsByTagName("WCIRCC")[0].childNodes[0].nodeValue;
      document.getElementById("wcircc").innerHTML = valor;
      
    } // Fim da Rotina CarregaVariaveis_GERCONS
    
    
    //***********************************************************************************************************************
    //                                                                                                                      *
    // Nome da Funcao Javascript: CarregaVariaveis_INV                                                                      *
    //                                                                                                                      *
    // Função: carrega na tabela HTML as variaveis de supervisao da seção INV lidas do arquivo XML                          *
    //                                                                                                                      *
    // Entrada: variavel com o arquivo XML recebido do Servidor                                                             *
    //                                                                                                                      *
    //***********************************************************************************************************************
    //	   
    function CarregaVariaveis_INV(ArqVarXML) {
      var i = 0;
      var inv = ArqVarXML.getElementsByTagName("INV");
		
          // Inversor 2
          valor = inv[i].getElementsByTagName("ESTIV2")[0].childNodes[0].nodeValue;
          document.getElementById("estiv2").innerHTML = valor;
          valor = inv[i].getElementsByTagName("IEIV2")[0].childNodes[0].nodeValue;
          document.getElementById("ieiv2").innerHTML = valor;
          valor = inv[i].getElementsByTagName("WEIV2")[0].childNodes[0].nodeValue;
          document.getElementById("weiv2").innerHTML = valor;
          valor = inv[i].getElementsByTagName("VSIV2")[0].childNodes[0].nodeValue;
          document.getElementById("vsiv2").innerHTML = valor;
          valor = inv[i].getElementsByTagName("ISIV2")[0].childNodes[0].nodeValue;
          document.getElementById("isiv2").innerHTML = valor;
          valor = inv[i].getElementsByTagName("WSIV2")[0].childNodes[0].nodeValue;
          document.getElementById("wsiv2").innerHTML = valor;
          valor = inv[i].getElementsByTagName("TDIV2")[0].childNodes[0].nodeValue;
          document.getElementById("tdiv2").innerHTML = valor;
          valor = inv[i].getElementsByTagName("TTIV2")[0].childNodes[0].nodeValue;
          document.getElementById("ttiv2").innerHTML = valor;
          valor = inv[i].getElementsByTagName("EFIV2")[0].childNodes[0].nodeValue;
          document.getElementById("efiv2").innerHTML = valor;
          valor = inv[i].getElementsByTagName("SDIV2")[0].childNodes[0].nodeValue;
          document.getElementById("sdiv2").innerHTML = valor;
		        
          // Inversor 1
          valor = inv[i].getElementsByTagName("ESTIV1")[0].childNodes[0].nodeValue;
          document.getElementById("estiv1").innerHTML = valor;
          valor = inv[i].getElementsByTagName("IEIV1")[0].childNodes[0].nodeValue;
          document.getElementById("ieiv1").innerHTML = valor;
          valor = inv[i].getElementsByTagName("WEIV1")[0].childNodes[0].nodeValue;
          document.getElementById("weiv1").innerHTML = valor;
          valor = inv[i].getElementsByTagName("VSIV1")[0].childNodes[0].nodeValue;
          document.getElementById("vsiv1").innerHTML = valor;
          valor = inv[i].getElementsByTagName("ISIV1")[0].childNodes[0].nodeValue;
          document.getElementById("isiv1").innerHTML = valor;
          valor = inv[i].getElementsByTagName("WSIV1")[0].childNodes[0].nodeValue;
          document.getElementById("wsiv1").innerHTML = valor;
          valor = inv[i].getElementsByTagName("TDIV1")[0].childNodes[0].nodeValue;
          document.getElementById("tdiv1").innerHTML = valor;
          valor = inv[i].getElementsByTagName("TTIV1")[0].childNodes[0].nodeValue;
          document.getElementById("ttiv1").innerHTML = valor;
          valor = inv[i].getElementsByTagName("EFIV1")[0].childNodes[0].nodeValue;
          document.getElementById("efiv1").innerHTML = valor;
          valor = inv[i].getElementsByTagName("SDIV1")[0].childNodes[0].nodeValue;
          document.getElementById("sdiv1").innerHTML = valor;
      
    } // Fim da Rotina CarregaVariaveis_INV

  </script> 
	    
</body>
</html>
